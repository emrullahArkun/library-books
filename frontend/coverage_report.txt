
[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90m/home/emrullah/library-books/frontend[39m
      [2mCoverage enabled with [22m[33mv8[39m

 [32mâœ“[39m src/features/my-books/hooks/useControllerLock.test.js[2m > [22museControllerLock[2m > [22mshould initialize optimally[32m 14[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useControllerLock.test.js[2m > [22museControllerLock[2m > [22mshould acquire lock and become controller[32m 3[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useControllerLock.test.js[2m > [22museControllerLock[2m > [22mshould maintain lock via heartbeat[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useControllerLock.test.js[2m > [22museControllerLock[2m > [22mshould detect existing valid lock from another tab[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useControllerLock.test.js[2m > [22museControllerLock[2m > [22mshould handle expired lock from another tab[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useControllerLock.test.js[2m > [22museControllerLock[2m > [22mshould renew lock if it expired but we were the controller[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useControllerLock.test.js[2m > [22museControllerLock[2m > [22mshould handle corrupt localStorage data[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useMyBooks.test.js[2m > [22museMyBooks wrapper tests[2m > [22mshould initialize and return books[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useMyBooks.test.js[2m > [22museMyBooks wrapper tests[2m > [22mshould allow toggling selection[32m 3[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useMyBooks.test.js[2m > [22museMyBooks wrapper tests[2m > [22mshould call delete mutation[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useMyBooks.test.js[2m > [22museMyBooks wrapper tests[2m > [22mshould call deleteAll mutation[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useMyBooks.test.js[2m > [22museMyBooks wrapper tests[2m > [22mshould update progress[32m 4[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/hooks/useMyBooks.test.js[2m > [22museMyBooks wrapper tests[2m > [22mshould handle optimistic empty data if not token[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/components/MyBookCard.test.jsx[2m > [22mMyBookCard[2m > [22mrenders the book cover and progress[32m 85[2mms[22m[39m
[90mstderr[2m | src/features/book-search/components/SearchResultCard.test.jsx[2m > [22m[2mSearchResultCard[2m > [22m[2mtriggers animation if book is NOT owned
[22m[39mWarning: React does not recognize the `fallbackIconSize` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `fallbackiconsize` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
    at img
    at NativeImage2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/image/native-image.mjs:6:11)
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at Image2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/image/image.mjs:11:5)
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/skeleton/skeleton.mjs:45:32
    at /home/emrullah/library-books/frontend/src/ui/BookCover.jsx:11:3
    at div
    at div
    at SearchResultCard (/home/emrullah/library-books/frontend/src/features/book-search/components/SearchResultCard.jsx:14:29)
Warning: React does not recognize the `fallbackIcon` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `fallbackicon` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
    at img
    at NativeImage2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/image/native-image.mjs:6:11)
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at Image2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/image/image.mjs:11:5)
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/skeleton/skeleton.mjs:45:32
    at /home/emrullah/library-books/frontend/src/ui/BookCover.jsx:11:3
    at div
    at div
    at SearchResultCard (/home/emrullah/library-books/frontend/src/features/book-search/components/SearchResultCard.jsx:14:29)

[90mstderr[2m | src/features/book-search/components/SearchResultCard.test.jsx[2m > [22m[2mSearchResultCard[2m > [22m[2mtriggers animation if book is NOT owned
[22m[39mWarning: An update to SearchResultCard inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at SearchResultCard (/home/emrullah/library-books/frontend/src/features/book-search/components/SearchResultCard.jsx:14:29)

[90mstderr[2m | src/features/book-search/components/SearchResultCard.test.jsx[2m > [22m[2mSearchResultCard[2m > [22m[2mdoes NOT trigger animation if book is owned by ID fallback
[22m[39mWarning: An update to SearchResultCard inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at SearchResultCard (/home/emrullah/library-books/frontend/src/features/book-search/components/SearchResultCard.jsx:14:29)

 [32mâœ“[39m src/features/my-books/components/MyBookCard.test.jsx[2m > [22mMyBookCard[2m > [22mrenders completed badge if completed[32m 24[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/components/MyBookCard.test.jsx[2m > [22mMyBookCard[2m > [22mrenders unknown pages if pageCount is 0[32m 7[2mms[22m[39m
 [32mâœ“[39m src/features/book-search/components/SearchResultCard.test.jsx[2m > [22mSearchResultCard[2m > [22mtriggers animation if book is NOT owned[32m 135[2mms[22m[39m
 [32mâœ“[39m src/features/book-search/components/SearchResultCard.test.jsx[2m > [22mSearchResultCard[2m > [22mdoes NOT trigger animation if book is owned by ID fallback[32m 20[2mms[22m[39m
[90mstderr[2m | src/features/my-books/MyBooks.test.jsx[2m > [22m[2mMyBooks Component[2m > [22m[2mrenders books from API
[22m[39mWarning: React does not recognize the `fallbackIconSize` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `fallbackiconsize` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
    at img
    at NativeImage2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/image/native-image.mjs:6:11)
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at Image2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/image/image.mjs:11:5)
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/skeleton/skeleton.mjs:45:32
    at /home/emrullah/library-books/frontend/src/ui/BookCover.jsx:11:3
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at MyBookCard (/home/emrullah/library-books/frontend/src/features/my-books/components/MyBookCard.jsx:19:3)
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at Flex2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/flex/flex.mjs:7:11)
    at div
    at /home/emrullah/library-books/frontend/node_modules/@emotion/react/dist/emotion-element-e8f4cc37.development.cjs.js:60:23
    at ChakraComponent2 (file:///home/emrullah/library-books/frontend/node_modules/@chakra-ui/react/dist/esm/system/system.mjs:36:15)
    at MyBooks (/home/emrullah/library-books/frontend/src/features/my-books/MyBooks.jsx:19:57)
    at Router (file:///home/emrullah/library-books/frontend/node_modules/react-router/dist/development/chunk-JMJ3UQ3L.mjs:6577:13)
    at MemoryRouter (file:///home/emrullah/library-books/frontend/node_modules/react-router/dist/development/chunk-JMJ3UQ3L.mjs:6493:3)
    at QueryClientProvider (file:///home/emrullah/library-books/frontend/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at ReadingSessionProvider (/home/emrullah/library-books/frontend/src/context/ReadingSessionContext.jsx:14:35)
    at /home/emrullah/library-books/frontend/src/features/my-books/MyBooks.test.jsx:33:13

 [32mâœ“[39m src/features/my-books/MyBooks.test.jsx[2m > [22mMyBooks Component[2m > [22mshows loading state initially[32m 84[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/components/MyBookCard.test.jsx[2m > [22mMyBookCard[2m > [22mtriggers onToggleSelect when checkbox is clicked[32m 104[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/components/MyBookCard.test.jsx[2m > [22mMyBookCard[2m > [22mnavigates to session on play button click[32m 12[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/components/MyBookCard.test.jsx[2m > [22mMyBookCard[2m > [22mnavigates to stats on chart button click[32m 9[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/MyBooks.test.jsx[2m > [22mMyBooks Component[2m > [22mrenders books from API[32m 109[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/MyBooks.test.jsx[2m > [22mMyBooks Component[2m > [22moptimistically updates "Mark as Read" status[32m 149[2mms[22m[39m
 [32mâœ“[39m src/features/my-books/MyBooks.test.jsx[2m > [22mMyBooks Component[2m > [22mhandles API errors gracefully[32m 11[2mms[22m[39m

[2m Test Files [22m [1m[32m5 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[32m25 passed[39m[22m[90m (25)[39m
[2m   Start at [22m 15:16:26
[2m   Duration [22m 1.73s[2m (transform 309ms, setup 1.14s, import 1.57s, tests 823ms, environment 1.84s)[22m

[34m % [39m[2mCoverage report from [22m[33mv8[39m
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |   49.66 |    41.41 |   34.43 |   50.96 |                   
 src               |     100 |      100 |     100 |     100 |                   
  i18n.js          |     100 |      100 |     100 |     100 |                   
 src/api           |   65.71 |    39.13 |      50 |   65.71 |                   
  apiClient.js     |   65.71 |    39.13 |      50 |   65.71 | ...43-46,53,74-98 
 src/context       |   30.64 |    13.04 |   23.68 |   31.79 |                   
  ...onContext.jsx |   14.81 |        0 |       0 |   17.39 | 9-32,44-48,53-81  
  AuthContext.jsx  |   12.76 |     12.5 |   11.11 |   13.04 | 7-78,88           
  ...onContext.jsx |   41.96 |    15.62 |   44.44 |   43.26 | ...57-163,195-199 
 ...tures/auth/api |      25 |      100 |       0 |      25 |                   
  authApi.js       |      25 |      100 |       0 |      25 | 4-6               
 ...rch/components |      75 |    61.11 |      50 |   78.26 |                   
  ...esultCard.jsx |      75 |    61.11 |      50 |   78.26 | 23-24,50-52       
  ...rd.module.css |       0 |        0 |       0 |       0 |                   
 ...ures/books/api |      20 |      100 |   11.11 |      20 |                   
  index.js         |      20 |      100 |   11.11 |      20 | 5-12              
 ...tures/my-books |   72.41 |       64 |      50 |   73.58 |                   
  MyBooks.jsx      |   72.41 |       64 |      50 |   73.58 | ...20,132,204-219 
 ...s/my-books/api |   15.38 |        0 |   14.28 |   18.18 |                   
  sessionsApi.js   |   15.38 |        0 |   14.28 |   18.18 | 5-15              
 ...oks/components |   41.93 |    41.66 |   44.44 |   41.93 |                   
  MyBookCard.jsx   |      80 |    83.33 |   66.66 |      80 | 36-37,221         
  ...ressModal.jsx |    6.25 |        0 |       0 |    6.25 | 5-35              
 ...my-books/hooks |   59.86 |    45.28 |   39.02 |   59.86 |                   
  ...rollerLock.js |   93.22 |    72.22 |   88.88 |   94.64 | 43,97-98          
  useMyBooks.js    |    38.7 |    31.42 |      25 |   38.46 | ...27,155-192,204 
 src/hooks         |     100 |      100 |     100 |     100 |                   
  ...Background.js |     100 |      100 |     100 |     100 |                   
 src/locales       |       0 |        0 |       0 |       0 |                   
  de.json          |       0 |        0 |       0 |       0 |                   
  en.json          |       0 |        0 |       0 |       0 |                   
 src/mocks         |   30.76 |      100 |   28.57 |   30.76 |                   
  handlers.js      |      25 |      100 |   28.57 |      25 | 40-59,77-91       
  server.js        |     100 |      100 |     100 |     100 |                   
 src/ui            |   54.54 |    50.79 |   33.33 |   58.82 |                   
  BookCover.jsx    |   54.54 |    50.79 |   33.33 |   58.82 | ...1-82,87-93,102 
 src/utils         |   63.63 |       10 |      50 |      70 |                   
  googleBooks.js   |   63.63 |       10 |      50 |      70 | 11-14             
-------------------|---------|----------|---------|---------|-------------------
